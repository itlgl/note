---
title: 阿里云服务器(Centos 8.1)初始化设置
date: 2021-04-11 12:20:12 
categories: 
- note
tags: 
---
### 1、添加操作用户itlgl，设置便捷登录方式  
  
#### 1.1 服务端命令  
  
```cmd  
// 创建新用户itlgl  
adduser itlgl  
  
// 设置itlgl的密码  
passwd itlgl  
  
// 给用户itlgl增加sudo权限  
// visudo命令默认会使用vi编辑器，在文件中  
visudo  
```  
  
`visudo`命令默认使用vi编辑器编辑，在文件中找到如下位置，仿照root用户，给普通用户添加权限，保存  
<br/>  
![visudo修改位置](https://user-images.githubusercontent.com/7078104/114302676-9e1bf300-9afc-11eb-80df-4f672cc33bba.PNG)  
<br/>  
  
```cmd  
// 切换到用户itlgl  
su itlgl  
  
// 生成sshkey，在默认位置生成rsa的sshkey  
ssh-keygen -t rsa  
```  
  
这里打断一下，用`WinSCP`用户名密码登录itlgl账户，将`.ssh/id_rsa`下载下来，使用putty下的`PuTTYgen`工具转换一下sshkey  
选择`Conversions -> Import Key`选择刚下载下来的`id_rsa`文件，工具会自动解析；  
选择`File -> Save Private Key`将转换完成的ppk文件保存到本地，用于putty的后续设置。  
  
```cmd  
// 复制pubkey为文件~/.ssh/authorized_keys  
cp ~/.ssh/id_rsa.pub ~/.ssh/authorized_keys  
  
// 设置.ssh文件夹只有itlgl用户有权限操作，否则sshkey不能使用  
chmod 600 ~/.ssh/authorized_keys  
chmod 700 ~/.ssh  
  
// 修改ssh配置文件  
vim /etc/ssh/sshd_config  
// 修改以下三个位置  
  PubkeyAuthentication yes //允许pubkey验证登录  
  PermitRootLogin no // 禁止root用户登录  
  PasswordAuthentication no //禁止密码验证登录  
  
// 重启ssh服务  
sudo service sshd restart  
```  
  
到这里服务端已经设置好了。  
  
#### 1.2 putty免密登录设置  
  
接下来是**putty**的免密登录设置：  
<br/>  
![putty-setting-1](https://user-images.githubusercontent.com/7078104/114303733-323c8900-9b02-11eb-9f4c-ffa487e8884d.PNG)  
<br/>  
![putty-setting-2](https://user-images.githubusercontent.com/7078104/114303737-35d01000-9b02-11eb-92bb-d4ce6159e952.PNG)  
<br/>  
![putty-setting-3](https://user-images.githubusercontent.com/7078104/114303742-38cb0080-9b02-11eb-92ae-b01904ed2296.PNG)  
<br/>  
**最后回到`Session`标签页，再点击`Save`保存一次即可。**  
  
#### 1.3 putty设置快捷登录方式  
  
桌面新建putty快捷方式，编辑`属性 -> 常规 -> 目标(T):` ，修改为`"C:\Program Files\PuTTY\putty.exe" -load aliyun_server`，最后的`aliyun_server`是上面你自定义的session名字，这样直接双击快捷方式可以直接登录到服务器，不用做任何输入操作。  
  
### To be continued...  
